```
'use client'

import React, {
  useState,
  useEffect,
  useCallback,
  useMemo,
  ReactNode,
  MouseEvent,
} from 'react'

/**
 * ButtonGroup
 *
 * A responsive grid that adjusts number of columns based on viewport width.
 *
 * Client‐Side Rendering Impact:
 *  - SEO: dynamic column counts won't appear in raw HTML, so search engines may not index perfect layout.
 *  - Initial Load: users may see one-column layout momentarily before JS runs.
 *  - Accessibility: region announces layout changes to screen readers.
 *
 * Performance Best Practices:
 *  - Wrapped updateCols in useCallback to avoid recreating on every render.
 *  - Dependency array only includes `cols`.
 */
export function ButtonGroup({
  cols = 3,
  gap = 1,
  children,
}: {
  cols?: number
  gap?: number
  children: ReactNode
}) {
  const [colsCount, setColsCount] = useState(cols)

  const updateCols = useCallback(() => {
    const w = window.innerWidth
    if (w < 640) {
      setColsCount(1)
    } else if (w < 768) {
      setColsCount(Math.min(cols, 2))
    } else {
      setColsCount(cols)
    }
  }, [cols])

  useEffect(() => {
    updateCols()
    window.addEventListener('resize', updateCols)
    return () => window.removeEventListener('resize', updateCols)
  }, [updateCols])

  return (
    <div
      role="region"
      aria-live="polite"
      style={{
        display: 'grid',
        gridTemplateColumns: `repeat(${colsCount}, minmax(0, 1fr))`,
        gap: `${gap}rem`,
      }}
    >
      {children}
    </div>
  )
}

/**
 * IconButton
 *
 * A full-width button with an icon, text, responsive hover-border & arrow fade.
 *
 * Client‐Side Rendering Impact:
 *  - SEO: icon/text always in HTML; dynamic border/arrow color applied post-hydration.
 *  - Initial Load: border/arrow may flash initial color.
 *  - Accessibility: uses semantic <a> with visible focus & hover states.
 *
 * Performance Best Practices:
 *  - useMemo for color calculations to avoid re-compute on every render.
 *  - useCallback for event handlers.
 */
export function IconButton({
  icon,
  text,
  href,
  newTab = false,
  size = 'md',
}: {
  icon: string
  text: string
  href: string
  newTab?: boolean
  size?: 'sm' | 'md' | 'lg'
}) {
  const [isDark, setIsDark] = useState(false)

  useEffect(() => {
    const html = document.documentElement
    const update = () => setIsDark(html.classList.contains('dark'))
    update()
    const mo = new MutationObserver(update)
    mo.observe(html, { attributes: true, attributeFilter: ['class'] })
    return () => mo.disconnect()
  }, [])

  const [bg, borderColor, hoverColor, arrowColor] = useMemo(() => {
    const bg = isDark ? '#0e0e0f' : '#ffffff'
    const lightBorder = '#D1D5DB'
    const lightHover = '#4B5563'
    const darkBorder = 'rgba(255, 236, 209, 0.1)'
    const darkHover = 'rgba(255, 236, 209, 1)'
    const lightArrow = '#6B7280'
    const darkArrow = 'rgba(255, 236, 209, 0.4)'
    return [
      bg,
      isDark ? darkBorder : lightBorder,
      isDark ? darkHover : lightHover,
      isDark ? darkArrow : lightArrow,
    ]
  }, [isDark])

  const sizeClasses = useMemo(() => {
    switch (size) {
      case 'sm':
        return 'px-4 py-3 text-sm'
      case 'lg':
        return 'px-8 py-7 text-lg'
      default:
        return 'px-6 py-5 text-base'
    }
  }, [size])

  const handleMouseEnter = useCallback(
    (e: MouseEvent<HTMLAnchorElement>) => {
      e.currentTarget.style.border = `1px solid ${hoverColor}`
      const svg = e.currentTarget.querySelector<SVGSVGElement>('.arrow-icon')
      if (svg) svg.setAttribute('stroke', hoverColor)
    },
    [hoverColor]
  )

  const handleMouseLeave = useCallback(
    (e: MouseEvent<HTMLAnchorElement>) => {
      e.currentTarget.style.border = `1px solid ${borderColor}`
      const svg = e.currentTarget.querySelector<SVGSVGElement>('.arrow-icon')
      if (svg) svg.setAttribute('stroke', arrowColor)
    },
    [borderColor, arrowColor]
  )

  return (
    <>
      <a
        href={href}
        target={newTab ? '_blank' : '_self'}
        rel={newTab ? 'noopener noreferrer' : undefined}
        className={`${sizeClasses} icon-btn relative flex items-center gap-x-3 w-full text-[var(--color-text)] rounded-xl not-prose group`}
        style={{ backgroundColor: bg, border: `1px solid ${borderColor}` }}
        onMouseEnter={handleMouseEnter}
        onMouseLeave={handleMouseLeave}
      >
        <div className="absolute top-5 right-5">
          <svg
            className="w-4 h-4 arrow-icon"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke={arrowColor}
            strokeWidth={2}
            strokeLinecap="round"
            strokeLinejoin="round"
          >
            <path d="M7 7h10v10" />
            <path d="M7 17L17 7" />
          </svg>
        </div>

        <div className="h-6 w-6">
          <img
            src={icon}
            alt=""
            className="h-full w-full object-contain"
            style={{
              filter: 'var(--color-filter)',
              color: 'var(--color-text)',
            }}
          />
        </div>

        <span className="not-prose font-semibold text-base">{text}</span>
      </a>

      <style jsx>{`
        .icon-btn {
          transition: border-color 150ms ease-in-out;
        }
        .icon-btn:hover {
          border-color: ${hoverColor} !important;
        }
        .icon-btn .arrow-icon {
          transition: stroke 150ms ease-in-out;
        }
        .icon-btn:hover .arrow-icon {
          stroke: ${hoverColor} !important;
        }
      `}</style>
    </>
  )
}
```